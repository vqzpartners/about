<script>
  // Configuración del Evento
  const eventConfig = {
    title: "Fin del Sorteo Especial",
    description: "Fecha límite para participar en el gran sorteo. ¡Mucha suerte!",
    location: "Online",
    // Fechas en formato: YYYYMMDDTHHmmSSZ (UTC)
    // 7 de Enero 2026 a las 12:00 PM (Ajustar según zona horaria si es necesario)
    start: "20260107T120000", 
    end: "20260107T130000"
  };

  // 1. Alternar menú desplegable
  function toggleCalendarMenu() {
    document.getElementById("cal-options").classList.toggle("show-cal");
  }

  // Cerrar menú si se hace clic fuera
  window.onclick = function(event) {
    if (!event.target.matches('.cal-btn')) {
      var dropdowns = document.getElementsByClassName("cal-options");
      for (var i = 0; i < dropdowns.length; i++) {
        var openDropdown = dropdowns[i];
        if (openDropdown.classList.contains('show-cal')) {
          openDropdown.classList.remove('show-cal');
        }
      }
    }
  }

  // 2. Google Calendar Link
  function addToGoogle() {
    const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventConfig.title)}&dates=${eventConfig.start}/${eventConfig.end}&details=${encodeURIComponent(eventConfig.description)}&location=${encodeURIComponent(eventConfig.location)}`;
    window.open(url, '_blank');
  }

  // 3. Outlook / Office 365 Link
  function addToOutlook() {
    const url = `https://outlook.live.com/calendar/0/deeplink/compose?path=/calendar/action/compose&rru=addevent&startdt=2026-01-07T12:00:00&enddt=2026-01-07T13:00:00&subject=${encodeURIComponent(eventConfig.title)}&body=${encodeURIComponent(eventConfig.description)}&location=${encodeURIComponent(eventConfig.location)}`;
    window.open(url, '_blank');
  }

  // 4. Apple Calendar / iCal (Genera archivo .ics)
  function addToApple() {
    const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
URL:${document.URL}
DTSTART:${eventConfig.start}
DTEND:${eventConfig.end}
SUMMARY:${eventConfig.title}
DESCRIPTION:${eventConfig.description}
LOCATION:${eventConfig.location}
END:VEVENT
END:VCALENDAR`;

    const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
    const link = document.createElement('a');
    link.href = window.URL.createObjectURL(blob);
    link.setAttribute('download', 'fin-sorteo.ics');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }
</script>
